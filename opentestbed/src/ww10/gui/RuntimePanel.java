package ww10.gui;

import java.awt.Font;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;

import javax.swing.BorderFactory;

import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.plot.PiePlot;
import org.jfree.data.general.DefaultPieDataset;

public class RuntimePanel extends ChartPanel {

	private static final long serialVersionUID = -534880050132416786L;

	private final DataModel dataModel;

	private final DefaultPieDataset dataset;

	public RuntimePanel(DataModel dataModel) {
		super(null);
		this.dataModel = dataModel;

		List<String> playerNames = dataModel.getPlayerNames();

		dataset = new DefaultPieDataset();
		for (String name : playerNames) {
			dataset.setValue(name, 1);
		}

		JFreeChart chart = ChartFactory.createPieChart(null, // chart title
				dataset, // data
				true, // include legend
				true, false);

		PiePlot plot = (PiePlot) chart.getPlot();

		plot.setLabelFont(new Font("SansSerif", Font.PLAIN, 20));
		plot.setNoDataMessage("Geen gegevens");
		//		plot.setCircular(false);
		//		plot.setLabelGap(0.02);

		//		p.setLabelGenerator(new StandardPieItemLabelGenerator("{0}"));
		//		p.setInteriorGap(0.30);
		plot.setBackgroundPaint(null);
		plot.setOutlineStroke(null);
		setBorder(BorderFactory.createLoweredBevelBorder());

		setChart(chart);
	}

	public void updateRuntime(Map<String, Long> runtime) {
		for (Entry<String, Long> entry : runtime.entrySet()) {
			long r = entry.getValue();
			if (r == 0) {
				r = 1;
			}
			double secs = (r / 1000.0);
			//			System.out.println(entry.getKey() + " ran for " + secs + " seconds");
			dataset.setValue(entry.getKey(), secs);
		}
	}

	public void setChosenName(String fixedName, String chosenName) {
		//		newDataset = new DefaultCategoryDataset();
		//		for (int r = 0; r < data.length; r++) {
		//			String rowKey = rowKeys[r];
		//			for (int c = 0; c < data[r].length; c++) {
		//				String columnKey = columnKeys[c];
		//				dataset.addValue(data[r][c], rowKey, columnKey);
		//			}
		//		}
		//		//		dataset.getRowIndex(fixedName)
		//		//		
		//		//		dataset.get.setKey(chosenName);
		//		setDataset
	}
}
